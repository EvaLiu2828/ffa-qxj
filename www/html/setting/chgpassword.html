<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">
<title>指尖金融家-修改密码</title>

	<script src="../../js/common/FFA.js"></script>
	<script src="../../js/common/initRootFontSize.js"></script>
	<script src="../../js/external/modernizr-min.js"></script>
	<link rel="stylesheet" href="../../css/base/base.css" />
	<link rel="stylesheet" href="../../css/component/component.css" />
    <link rel="stylesheet" href="../../css/page/setting/chgpassword.css">
</head>
<body>
			<div class="pos-abs sz-con">
				<header class="header">
					<span class="header-btn header-left-btn icon-left-arrow" onclick="history.back();"></span>
					<span class="header-title">修改密码</span>
				</header>
				<div class="me-bt content">
					<div class="chg-mid marAuto">
						<div>
							<p class="chg-p1">旧密码</p>
							<!--<input class="chg-ipt1" type="text" placeholder="6-12个字符，区分大小写"/>-->
							<!--<span class="chg-spn"></span>-->
							<div class="js-emptiableinput-wrapper input-wrapper empty">
								<input class="chg-ipt1 across-input" type="text" maxlength="20" placeholder="6-20个字符，区分大小写">
								<span class="chg-spn icon-del"></span>
							</div>
							<p class="chg-p2 chg-p3 chg-passWordold">旧密码有误,请重新输入</p>
							<!--<p class="chg-p2 chg-p3 chg-passWordoldwrong">请输入正确的密码长度</p>-->
						</div>
						<div>
							<p class="chg-p1">新密码</p>
							<!--<input class="chg-ipt2" type="text" placeholder="密码由（8-12个字符）组成"/>-->
							<!--<span class="chg-spn"></span>-->
							<div class="js-emptiableinput-wrapper input-wrapper empty">
								<input class="chg-ipt2 across-input" type="text" maxlength="20" placeholder="密码由（8-20个字符）组成">
								<span class="chg-spn icon-del"></span>
							</div>
							<p class="chg-p2 chg-p4 chg-passWordNew">请输入正确的密码长度</p>
						</div>
						
						<div>
							<a class="chg-a marAuto btn-h chg-aTap com-middle-btn-d disabled" href="javascript:">确定</a>
							<p class="chg-p3 chg-passwordShow marAuto" style="float: left;margin-top:12px; margin-left: 4.5%;width:30%">
								<span class="chg-sp"></span>
								显示密码
							</p>
						</div>
					</div>		
				</div>
			</div>
			<!--弹出框 网络无法连接-->
			<div class="chg-alt1 ndis chg_noNet">	
			</div>
			<div class="chg-alt2 ndis chg_noNet">
				<h2>请求服务器超时</h2>
				<p class="chg-sure marAuto chg-sure1">确定</p>
				 
			</div>

			<!--弹出框 密码修改成功-->
			
			<div class="chg-alt1 ndis chg-passwordSuccess">	
			</div>
			<div class="chg-alt2 ndis chg-passwordSuccess">
				<img class="chg-ys marAuto" src="../../images/yes.png">
				<h2 style="margin-top: 4%;">密码修改成功</h2>
				<p class="chg-sure marAuto chg-sure2">重新登录</p>
				 
			</div>

			<!--弹出框  后台失败返回信息-->
			
			<div class="chg-alt1 ndis chg-passwordFail">	
			</div>
			<div class="chg-alt2 ndis chg-passwordFail">
				
				<h2 style="margin-top: 20%;" class="chg-passwordFail-words">哈哈哈</h2>
				<p class="chg-sure marAuto chg-sure5">确定</p>
				 
			</div>

			<!--弹出框 正在加载-->
			<!--<div style="position:absolute;width:100%;height:100%;top:0px;" class="ndis chg-alt5 chg_loading"></div>-->
			<!--&lt;!&ndash;v1.4 start&ndash;&gt;-->
			<!--&lt;!&ndash;<div class="chg-alt3 ndis chg_loading">	&ndash;&gt;-->
			<!--&lt;!&ndash;</div>&ndash;&gt;-->
			<!--&lt;!&ndash;v1.4 end&ndash;&gt;-->
			<!--<div class="chg-alt4 ndis chg_loading" style="left: 0;width: 100%">-->
				<!--<img class="chg-ys marAuto" style="width:69px;position: absolute;left:50%;margin:0;margin-left: -34.5px" src="../../images/load.gif">-->
			<!--</div>-->
<script src="../../js/external/zepto.min.js"></script>
<script src="../../js/core/detect.js"></script>
<script src="../../js/common/strings.js"></script>
<script src="../../js/common/local_storage_utils.js"></script>
<script src="../../js/callback/http/change_pwd_callback.js"></script>
<script src="../../js/common/hashmap.js"></script>
<script src="../../js/common/constant.js"></script>
<script src="../../js/common/config.js"></script>
<script src="../../js/external/fastclick.js"></script>
<script src="../../js/common/http_response.js"></script>
<script src="../../js/common/ajax_common.js"></script>
<script src="../../js/common/utils.js"></script>
<script src="../../js/common/constant.js"></script>
<script src="../../cordova.js"></script>
<script src="../../js/common/main.js"></script>
<script src="../../js/common/json_conversion.js"></script>
<script src="../../js/common/exit_system.js"></script>
<script type="text/javascript" src="../../js/callback/http/check_version_callback.js"></script>
<script type="text/javascript" src="../../js/common/offline.js"></script>
<script type="text/javascript" src="../../js/common/pause.js"></script>
<script type="text/javascript" src="../../js/common/resume.js"></script>
<!--2015-7-7 wangjunbao-->
<script src="../../js/external/indexeddbshim.min.js" ></script>
<script src="../../js/callback/http/exit_callback.js"></script>
<script src="../../js/common/component/popup.js"></script>
<script src="../../js/common/component/input.js"></script>
<!--2015-7-7 wangjunbao-->

<!--<script src="../js/common/network.js"></script>
<script type="text/javascript" src="../cordova.js"></script>-->
<script>
 	$(function(){

 		var bind_name = 'input';  
     if (navigator.userAgent.indexOf("MSIE") != -1){  
                bind_name = 'propertychange';  
      } 
// 		$(".chg-mid input").focus(function(){
// 			//$(this).addClass("chg-bg");
//			$(this).next().show();
// 		});
// 		$(".chg-mid input").blur(function(){
// 		//	$(this).removeClass("chg-bg");
//			$(this).next().hide();
//		//	$(".chg-spn").hide();
// 		});
 		$(".chg-spn").on("tap", function(){
 			$(this).prev().val('');
			$(this).prev().focus();
			$(".chg-passWordold").css("visibility","hidden");
			$(".chg-passWordNew").css("visibility","hidden");
			if($(".chg-ipt2").val()==""||$(".chg-ipt1").val()==""){
				$(".chg-a").removeClass("btn-L");	
 				$(".chg-a").addClass("btn-h");
				$(".chg-a").addClass("disabled");
			}
 		});
 		var chgpassword_n_lj=1;
 		$(".chg-passwordShow").bind("click",function(){	
 			if((chgpassword_n_lj%2)==1){
 				$(".chg-p3 span").removeClass("chg-sp");
 				$(".chg-mid input").attr("type","password");
 				
 				chgpassword_n_lj++;
 			}else{
 				$(".chg-p3 span").addClass("chg-sp");
 				$(".chg-mid input").attr("type","text");
 				chgpassword_n_lj++;
 			}
 		});
 		$(".chg-ipt2,.chg-ipt1").bind(bind_name,function(){
 			if(($(".chg-ipt2").val().length>=8&&$(".chg-ipt2").val().length<=20)&&($(".chg-ipt1").val().length>=6&&$(".chg-ipt1").val().length<=20))
 			{
 			$(".chg-a").removeClass("btn-h");	
 			$(".chg-a").addClass("btn-L");
			$(".chg-a").removeClass("disabled");
 			}else{
 				$(".chg-a").removeClass("btn-L");	
 				$(".chg-a").addClass("btn-h");
				$(".chg-a").addClass("disabled");
 			}
 			  
 		});
 		$(".chg-ipt1").bind(bind_name,function(){
 				if($(".chg-ipt1").val().length<6||$(".chg-ipt1").val().length>20){
 					$(".chg-passWordold").css("visibility","visible").text("请输入正确的密码长度");
 				}else{
 					$(".chg-passWordold").css("visibility","hidden").text("旧密码有误，请重新输入");
 				}
 				 
 			});
 		$(".chg-ipt2").bind(bind_name,function(){
 				if($(".chg-ipt2").val().length<8||$(".chg-ipt2").val().length>20){
 					$(".chg-passWordNew").css("visibility","visible");
 				}else{
 					$(".chg-passWordNew").css("visibility","hidden");
 				}
 				 
 			});
 		$(".chg-sure1").bind("click",function(){
 			$(".chg-alt1").addClass("ndis").next().addClass("ndis");
 		});

 		$(".chg-sure2").bind("click",function(){
 			window.location.href="../login/login.html";
 		});
 		$(".chg-sure5").bind("click",function(){
 			$(".chg-passwordFail").addClass("ndis");
 		});
 		
 		$(".chg-aTap").bind("click",function(){
 			if($(".chg-aTap").hasClass("btn-L")){
 				//$(".chg_loading").removeClass("ndis");

				// 加载中动画...
				var Components = FFA.namespace('Components');
				var loading = Components.Popup.Loading('A');

 				passwordCheck(loading);
 				//setTimeout("passwordCheck()",1000); 

 			}
 		})
 		
 	});
function passwordCheck(loading){
			var hashMap = new HashMap();
			var deviceUUID=getDeviceUUID();
			var userID=get(user_uuid);
			var myPhoneNumber=get(me_phonenumber);
			//alert(deviceUUID);
			var haveOldPassword=$(".chg-ipt1").val();
			//alert(haveOldPassword);
			var changePassword=$(".chg-ipt2").val();
 			$(".chg-alt3").addClass("ndis");

			loading.remove();

 			hashMap.put(userUUID,userID);
	 		hashMap.put(devUUID,deviceUUID);
	 		hashMap.put(phoneNumber,myPhoneNumber);
	 		hashMap.put(flag,0);
	 		hashMap.put(userFeedback,"");
	 		hashMap.put(oldPassWrod,haveOldPassword);	 				
			hashMap.put(newPassWord,changePassword);
			http_post(changepwdAndFeedBack_interface,getJsonStr(hashMap),change_pwd_success,change_pwd_fail);
 		}
</script>	
</body>
</html>